<!doctype html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="Devoirs à la Maison : Utilisation de MatPlotLib, Pandas et de requête HTTP pour résoudre des problèmes communs."><meta property="og:url" content="{{ url_prefix }}/{{ permalink }}"><meta property="og:title" content="Devoir à la Maison 5 - Approfondissement sur les modules Python"><meta property="og:description" content="Devoirs à la Maison : Utilisation de MatPlotLib, Pandas et de requête HTTP pour résoudre des problèmes communs."><meta property="og:image" content="/algo-appliquee/assets/logo.png"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous"><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin="anonymous"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.24.1/themes/prism-okaidia.css" rel="stylesheet" integrity="sha256-nwDipdLn93O1CZGoRDor0i4CLmDQb+mdg/yaYMUCuLM=" crossorigin="anonymous"><link href="/algo-appliquee/assets/site.css" rel="stylesheet"><title>Devoir à la Maison 5 - Approfondissement sur les modules Python</title><script>window.WebFontConfig = {
        custom: {
          families: ['KaTeX_AMS', 'KaTeX_Caligraphic:n4,n7', 'KaTeX_Fraktur:n4,n7',
            'KaTeX_Main:n4,n7,i4,i7', 'KaTeX_Math:i4,i7', 'KaTeX_Script',
            'KaTeX_SansSerif:n4,n7,i4', 'KaTeX_Size1', 'KaTeX_Size2', 'KaTeX_Size3',
            'KaTeX_Size4', 'KaTeX_Typewriter'],
        },
      };</script><script defer="defer" src="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js" integrity="sha256-4O4pS1SH31ZqrSO2A/2QJTVjTPqVe+jnYgOWUVr7EEc=" crossorigin="anonymous"></script></head><body class="bg-dark"><header class="navbar navbar-expand-lg navbar-dark bg-dark shadow"><div class="container-fluid"><a class="navbar-brand" href="/algo-appliquee/">Algorithmique Appliquée avec Python</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Etendre le menu"><span class="navbar-toggler-icon"></span></button></div></header><div class="container-fluid"><div class="row"><nav id="sidebarMenu" class="navbar-expand-lg col-lg-3 bg-light sidebar collapse"><ul class="nav flex-column"><li class="nav-item"><a class="nav-link" href="/algo-appliquee/"><span data-feather="home"></span> Accueil</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/trame/"><span data-feather="file"></span> Trame du cours</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/00-avant-propos/"><span data-feather="file-text"></span> Avant-propos</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/references/"><span data-feather="shopping-cart"></span> Références</a></li></ul><h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>Cours</span></h6><ul class="nav flex-column mb-2"><li class="nav-item"><a class="nav-link" href="/algo-appliquee/01-intro-programmation/"><span data-feather="file-text"></span> Introduction</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/02-bases-python/"><span data-feather="file-text"></span> Bases du Python</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/03-programmes-simples/"><span data-feather="file-text"></span> Programmes simples</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/04-fonctions/"><span data-feather="file-text"></span> Fonctions</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/05-structures-donnees/"><span data-feather="file-text"></span> Structures de données</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/06-problemes-classiques/"><span data-feather="file-text"></span> Problèmes classiques</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/07-complexite/"><span data-feather="file-text"></span> Complexité</a></li><li class="nav-item"><a class="nav-link" href="/algo-appliquee/08-tests/"><span data-feather="file-text"></span> Tests</a></li></ul></nav><main class="col-lg-9 ms-sm-auto px-md-4"><div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"><h1>Devoir à la Maison 5 - Approfondissement sur les modules Python</h1></div><p><img src="./assets/entete-cci.png" alt="Entête CCI"></p><p>Ce devoir à la maison va donner lieu à une note sur 20. Il doit être rendu avant le début du prochain cours.</p><p>Ce 5e DM vous amène à revoir des éléments de cours vu aujourd’hui concernant les modules.</p><p>Pour les autres exercices, vous devez créer un fichier nommé <code>dm05_exercice_X.py</code> où X est le numéro de l’exercice.</p><p>Vous devrez créer une archive <code>dm05.zip</code> contenant tous vos fichiers et l’envoyer à <a href="mailto:loic@yvo.solutions">loic@yvo.solutions</a>.</p><h2>Exercice 1 - Moteur de recherche en ligne de commande</h2><p>Vous allez implémenter un utilitaire permettant d’effectuer une recherche Internet à l’aide :</p><ul><li>du moteur de recherche Qwant,</li><li>du module <code>requests</code>,</li><li>du module <code>inscriptis</code>.</li></ul><p>A l’aide de <code>pip</code>, installez les paquets <code>requests</code> et <code>inscriptis</code> depuis un terminal. Ensuite, créez un nouveau script Python.</p><h3>Exercice 1.1 - Construction de l’URL</h3><p>A l’aide de la fonction <code>input</code>, demandez à l’utilisateur de rentrer ses termes de recherche.</p><p>Ensuite, concatenez ces termes en utilisant un <code>&quot;+&quot;</code> comme séparateur. La chaîne de caractères ne doit plus comporter d’espace ni de caractères accentués (é, è, ê, ë, à, â, etc.).</p><p>Par exemple, si l’utilisateur a rentré <code>&quot;chat gris&quot;</code>, votre chaîne de caractères doit devenir <code>&quot;chat+gris&quot;</code>.</p><p>Créez ensuite une variable nommée <code>url</code> telle que :</p><ul><li>Elle comporte le préfix <code>&quot;https://www.qwant.com/?q=&quot;</code>,</li><li>Puis les termes de recherches concaténés,</li><li>Et enfin le suffix <code>&quot;&amp;t=web&quot;</code>.</li></ul><p>En poursuivant notre exemple, la variable <code>url</code> serait <code>&quot;https://www.qwant.com/?q=chat+gris&amp;t=web&quot;</code>.</p><h3>Exercice 1.2 - Envoie de la requête HTTP</h3><p>En utilisant le module <code>requests</code>, effectuez une requête HTTP GET sur l’<code>url</code> et récupérez la réponse en sortie.</p><p>Le code HTML de la page se trouve dans la propriété <code>text</code> de la réponse HTTP.</p><h3>Exercice 1.3 - Désérialisation de la réponse HTTP</h3><p>Le résultat de la réponse HTTP est une chaîne de caractères au format HTML. Il s’agit d’un format qui nécessite une interprétation avant d’être affichée.</p><p>En utilisant le module <code>inscriptis</code>, convertissez le code HTML de la page en texte simple (à l’aide de <code>get_text</code>). Utilisez la fonction <code>print</code> pour afficher ce texte dans la sortie.</p><h3>Exercice 1.4 - Usurpation d’identité</h3><p>Le résultat obtenu à ce stade est déroutant : il n’y a aucun résultat de recherche ! La même recherche dans un navigateur web donne un résultat différent. La raison est simple : utiliser une API Web est un service payant de manière générale.</p><p>La question qui suit est : comment le serveur de recherche (Google, Bing, Qwant et autres) reconnait-il des requêtes faites depuis un navigateur web ? Comment faire la distinction avec des requêtes effectuées en ligne de commande ?</p><p>En pratique, une requête HTTP comporte des entêtes. L’une de ces entêtes s’appelle le User Agent, et identifie la nature de l’entité qui effectue la requête.</p><p>On peut donc se faire passer pour un navigateur web pour obtenir des résultats de recherche :</p><pre class="language-py"><code class="language-py">firefox <span class="token operator">=</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"</span><br>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span>firefox<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>En revanche, il ne faut pas exécuter la requête un nombre de fois trop élevé :</p><ul><li>un navigateur web implémente un cache navigateur qui va minimiser le nombre de requêtes effectuées au serveur, contrairement à l’outil naïf en cours d’implémentation,</li><li>les moteurs de recherche limitent le nombre de requêtes que l’on peut effectuer sur un laps de temps donné sans passer par leur site (en utilisant d’autres mécanimes),</li><li>si les moteurs de recherche ne peuvent pas se rémunérer avec la publicité, il est normal qu’ils utilisent un autre modèle économique de rémunération - ici, au nombre de requêtes effectuées sur le laps de temps donné -,</li></ul><p>Par ailleurs, il faut être conscient qu’il s’agit d’un hack et non pas d’une vraie solution viable. En effet :</p><ul><li>changer l’identité du User Agent n’est pas une bonne pratique sauf lorsque l’on souhaite tester des problématiques de cybersécurité,</li><li>il ne faut pas changer l’identité du User Agent dans des solutions industrielles.</li></ul><h2>Exercice 2 - Tableau de points</h2><p>Téléchargez un <a href="https://github.com/loic-yvonnet/algo-appliquee/raw/master/cours/10-python-avance/assets/random-curve.csv">fichier de points au format CSV</a>.</p><p>Le format CSV (pour Comma Separated Values) est un format de fichier commun pour décrire le contenu d’un tableur ou d’une base de données.</p><p>Le fichier <code>random-curve.csv</code> que vous venez de télécharger comporte simplement 2 colonnes : les abscisses X et les ordonnées Y d’une fonction. Les valeurs sont séparées par un <code>&quot;;&quot;</code>.</p><h3>Exercice 2.1 - Lire le fichier CSV</h3><p>A l’aide du module <code>csv</code> et de sa fonction <code>reader</code>, lisez le fichier de points et affichez dans la sortie standard de la console la liste des 20 premières ordonnées.</p><h3>Exercice 2.2 - Affichage de la courbe</h3><p>A l’aide du package MapPlotLib, affichez la courbe correspondant au nuage de points présent dans le fichier CSV.</p><p>Le résultat attendu est : <img src="./assets/random-curves.png" alt="Courbe"></p><h2>Exercice 3 - Tableur</h2><h3>Exercice 3.1 - Récupération d’une base de données de films</h3><p>En suivant la même approche que dans l’exercice 1, écrivez une requête HTTP qui récupère le fichier CSV à l’adresse : <a href="https://raw.githubusercontent.com/PacktPublishing/Pandass-Cookbook/master/data/movie.csv">https://raw.githubusercontent.com/PacktPublishing/Pandass-Cookbook/master/data/movie.csv</a>.</p><p>Ecrivez le contenu dans un fichier local.</p><p>En suivant la même approche que dans l’exercice 2, affichez les 20 premières lignes dans la sortie standard.</p><h3>Exercice 3.2 - Lecture et affichage avec Pandas</h3><p>Pandas, tout comme NumPy et MatPlotLib, fait parti des bibliothèques qui font la popularité du langage Python ces dernières années. Il s’agit d’une bibliothèque de gestion de données tabulaires. Il est possible de faire les mêmes opérations que dans un tableur Excel, mais plus facilement et sans avoir à utiliser Visual Basic for Applications (VBA), qui est un langage de programmation ancien.</p><p>A l’aide pip, installez la bibliothèque <code>pandas</code> (attention au <strong>s</strong> à la fin).</p><p>Utilisez la fonction <code>read_csv</code> de <code>pandas</code> pour relire le fichier csv sauvegardé précédemment. Utilisez la fonction <code>head</code> pour afficher les 20 premières lignes.</p><h3>Exercice 3.3 - Analyse avec Pandas</h3><p>Avec la propriété <code>shape</code>, affichez le nombre de lignes et le nombre de colonnes de votre tableau.</p><p>Avec la fonction <code>info</code>, affichez quelques informations sur vos données.</p><p>Avec la fonction <code>describe</code>, affichez des statistiques sur la distribution des variables continues.</p><p>Avec la fonction <code>corr</code>, affichez la corrélation entre chaque variable continue.</p><p>En utilisant l’opérateur <code>[]</code> pour sélectionner la colonne <code>genres</code>, et en utilisant la fonction <code>value_counts</code>, affichez le nombre de films répertoriés par genre.</p><h3>Exercice 3.4 - Requêtes avancées avec Pandas</h3><p>Dans l’exercice précédent, nous avons vu comment sélectionner une colonne.</p><p>Il est possible de filtrer le contenu en suivant la même logique. Par exemple, si la variable pandas s’appelle <code>films</code>, on peut utiliser <code>films[(films[&quot;title_year&quot;] == 2006)]</code> pour n’affichez que la liste des films parus en 2006.</p><p>On peut combiner des filtres avec l’opérateur <code>&amp;</code>. Ainsi :</p><pre class="language-python"><code class="language-python">films<span class="token punctuation">[</span><br>    <span class="token punctuation">(</span>films<span class="token punctuation">[</span><span class="token string">"title_year"</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">2006</span><span class="token punctuation">)</span><br>    <span class="token operator">&amp;</span> <span class="token punctuation">(</span>films<span class="token punctuation">[</span><span class="token string">"title_year"</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">2008</span><span class="token punctuation">)</span><br><span class="token punctuation">]</span></code></pre><p>va afficher la liste des films entre 2006 et 2008.</p><p>Affichez la liste des films d’Action sortis après 2010, ayant au moins 10000 likes Facebook, et paru aux USA.</p><p>Avec la fonction <code>value_counts</code>, affichez leur nombre.</p><h3>Exercice 3.5 - Affichage de graphiques avec Pandas et MatPlotLib</h3><p>Affichez la courbe de l’évolution du budget médian par année aux USA.</p><p>Le résultat attendu est : <img src="./assets/budget-median.png" alt="Courbe"></p><p><em>Astuces</em> :</p><ul><li>Utilisez un filtre comme dans l’exercice précédent pour limiter les résultats aux USA.</li><li>Appliquez un <code>pivot_table</code> sur le budget indexé par année en utilisant une médiane comme fonction d’aggrégation.</li><li>Utilisez la fonction <code>plot</code> sur la <code>DataFrame</code>.</li><li>Utilisez MatPlotLib pour formatter le graphique et l’afficher avec <code>plot.show()</code>.</li></ul></main></div></div><footer class="bd-footer py-5 bg-dark"><div class="container-fluid py-5"><div class="row"><div class="col-lg-3 d-md-block collapse"></div><div class="col-lg-9 ms-sm-auto px-md-4"><a class="d-inline-flex align-items-center mb-2 link-light text-decoration-none" href="/" aria-label="Algorithmique Appliquée"><span class="fs-5">Algorithmique Appliquée</span></a><ul class="list-unstyled small text-muted"><li class="mb-2">BTS SIO SISR - 1ière année - Session 2021 - 2022</li><li class="mb-2">Code source sous licence <a href="https://github.com/loic-yvonnet/algo-appliquee/blob/master/LICENSE" target="_blank" rel="license noopener" class="link-light">MIT</a>, et cours sous licence <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="license noopener" class="link-light">CC BY-NC 4.0</a>.</li><li class="mb-2"><address><span>Contact :</span> <a href="mailto:loic@yvo.solutions" class="link-light">loic@yvo.solutions</a></address></li></ul></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script><script>feather.replace();</script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha256-qVJed55YB6+tZ9LzJ0xVZTArcMw2XXxjFeeRIEUmwOk=" crossorigin="anonymous"></script><script>katexOptions = {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$", right: "$", display: false} // means inline...
        ]
      };</script><script src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body, katexOptions);"></script></body></html>